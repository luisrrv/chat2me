<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Chat2Me</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            background: url('https://images.unsplash.com/photo-1526403225-3ed9d4826d72?auto=format&fit=crop&w=1920&q=80') no-repeat center center fixed;
            background-size: cover;
        }
    </style>
</head>

<body class="flex items-center justify-center min-h-screen px-4 py-8">

    <div
        class="backdrop-blur-xl bg-white/30 border border-white/20 shadow-xl rounded-3xl max-w-md w-full p-6 space-y-4 text-gray-900">
        <h1 class="text-2xl font-semibold text-center text-gray-800 drop-shadow">ðŸ’¬ Chat2Me</h1>

        <ul id="chatLog"
            class="space-y-2 h-64 overflow-y-auto bg-white/10 backdrop-blur rounded-xl p-3 text-sm text-gray-800 border border-white/20 shadow-inner">
            <!-- messages go here -->
        </ul>

        <div class="flex gap-2">
            <input id="msgInput" type="text" placeholder="Type your message..."
                class="flex-1 bg-white/20 backdrop-blur placeholder-gray-500 border border-white/30 rounded-xl px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-400 text-gray-900" />
            <button onclick="sendMessage()"
                class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-xl transition shadow-md">
                Send
            </button>
        </div>
    </div>

    <script>
        const visitorId = 'visitor-' + Math.random().toString(36).slice(2, 6);
        // const socket = new WebSocket(`ws://${location.host}?visitorId=${visitorId}`);
        const socket = new WebSocket(`wss://chat2me-backend.onrender.com?visitorId=${visitorId}`);

        socket.onmessage = (event) => {
            const el = document.createElement('li');
            el.textContent = event.data;
            document.getElementById('chatLog').appendChild(el);
            document.getElementById('chatLog').scrollTop = document.getElementById('chatLog').scrollHeight;
        };

        function sendMessage() {
            const input = document.getElementById('msgInput');
            const msg = input.value.trim();
            if (msg) {
                socket.send(msg);

                // Show your own message immediately
                const el = document.createElement('li');
                el.textContent = `You: ${msg}`;
                document.getElementById('chatLog').appendChild(el);
                document.getElementById('chatLog').scrollTop = document.getElementById('chatLog').scrollHeight;

                input.value = '';
            }
        }
    </script>
</body>

</html>